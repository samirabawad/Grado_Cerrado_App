<ion-content class="racha-content">

  <!-- Header estilo dashboard -->
  <div class="dashboard-header">
    <ion-icon name="chevron-back" class="back-icon" (click)="goBack()"></ion-icon>
    <h1 class="header-title">La Racha</h1>
  </div>

  <!-- Spinner de carga -->
  <div *ngIf="isLoading" class="loading-container">
    <ion-spinner name="circular"></ion-spinner>
  </div>

  <div *ngIf="!isLoading" class="content-area">

    <!-- Tarjeta principal de racha CON LLAMA -->
    <div class="streak-main-card">
      <div class="streak-display">
        <div class="streak-icon">
          <ion-icon name="flame" class="flame-icon"></ion-icon>
        </div>
        <div class="streak-number">{{ currentStreak }}</div>
      </div>
      <div class="streak-label">dÃ­as de racha</div>
      
      <div class="streak-message-large">
        <span *ngIf="currentStreak === 0">Â¡Comienza tu racha hoy!</span>
        <span *ngIf="currentStreak > 0 && currentStreak < 5">Â¡Vas muy bien!</span>
        <span *ngIf="currentStreak >= 5 && currentStreak < 10">Â¡IncreÃ­ble constancia!</span>
        <span *ngIf="currentStreak >= 10 && currentStreak < 30">Â¡Eres imparable!</span>
        <span *ngIf="currentStreak >= 30">Â¡Leyenda viviente!</span>
      </div>
    </div>

<!-- CALENDARIO MENSUAL -->
    <div class="calendar-card">
      <div class="month-navigation">
        <button class="nav-arrow" (click)="navigateMonth(-1)" [disabled]="!canNavigateBack()">
          <ion-icon name="chevron-back"></ion-icon>
        </button>
        <h3 class="calendar-title">{{ currentMonthName }}</h3>
        <button class="nav-arrow" (click)="navigateMonth(1)" [disabled]="isCurrentMonth">
          <ion-icon name="chevron-forward"></ion-icon>
        </button>
      </div>

      <div class="calendar-weekdays">
        <div class="weekday">D</div>
        <div class="weekday">L</div>
        <div class="weekday">M</div>
        <div class="weekday">M</div>
        <div class="weekday">J</div>
        <div class="weekday">V</div>
        <div class="weekday">S</div>
      </div>

      <div class="calendar-grid">
        <div 
          *ngFor="let calDay of calendarDays"
          class="calendar-day"
          [class.studied]="calDay.hasStudied"
          [class.today]="calDay.isToday"
          [class.empty]="!calDay.isCurrentMonth">
          <span *ngIf="calDay.isCurrentMonth">{{ calDay.day }}</span>
        </div>
      </div>
      
      <div class="calendar-legend">
        <div class="legend-item">
          <div class="legend-box studied"></div>
          <span>DÃ­a estudiado</span>
        </div>
        <div class="legend-item">
          <div class="legend-box today"></div>
          <span>Hoy</span>
        </div>
      </div>
    </div>

    <!-- LOGROS EN CUADRÃCULA -->
    <div class="achievements-section">
      <h3 class="section-title">ğŸ† Logros de Racha</h3>
      <div class="achievements-grid">
        <div 
          *ngFor="let achievement of achievements"
          class="achievement-card"
          [class.unlocked]="achievement.unlocked"
          [class.locked]="!achievement.unlocked">
          
          <div class="achievement-icon" [style.background]="achievement.unlocked ? achievement.color : '#e5e7eb'">
            <ion-icon [name]="achievement.icon"></ion-icon>
          </div>
          
          <div class="achievement-info">
            <div class="achievement-title">{{ achievement.title }}</div>
            <div class="achievement-days">{{ achievement.daysRequired }} dÃ­as</div>
          </div>
          
          <div class="achievement-status">
            <ion-icon 
              *ngIf="achievement.unlocked" 
              name="checkmark-circle" 
              class="unlocked-check"></ion-icon>
            <ion-icon 
              *ngIf="!achievement.unlocked" 
              name="lock-closed" 
              class="locked-icon"></ion-icon>
          </div>
        </div>
      </div>
    </div>

  </div>

  <app-bottom-nav></app-bottom-nav>
</ion-content>
